
@{
    Layout = "_Layout";
}

@model Report401ViewModel
<style>
    .singleInput{
        border: 0;
        border-bottom: double;
    }
</style>

<h6 class="k-text-right">म.ले.प.फाराम नं: <span id="MLPNo">@Model.MLPFormNo</span></h6>
<div class="container" id="formDiv">
    <form method="post" id="requestForm">
        <h5 class="k-text-center">
            सङ्घ/ प्रदेश / स्थानीय तह
        </h5>
        <h5 class="k-text-center">
            <input class="singleInput" type="text" id="OfficeName" /> <label>मन्त्रालय / विभाग / कार्यालय</label>
        </h5>
        <h6 class="k-text-center">
            <label>कार्यालय कोड नं</label><input class="singleInput" type="text" id="OfficeId" />
        </h6>
        <br />
        <h5 class="k-text-center" id="FormName"><b>@Model.FormName</b></h5>
        <div class="container k-text-right">
            <lable>आर्थिक वर्ष :</lable><input type="number" id="FiscalYear" style="width:auto;"/><br />
            <label>माग फाराम नं:</label><input type="text" id="FormId" style="width:auto;" /><br />
            <label>मितिः</label><input style="width:200px;" id="FormDate"/> 
        </div> 
        <div class="container">
            <div id="ItemsGrid"></div>
        </div>
        <div class="container row">
            <div class="col-4">
                <label>माग गर्ने:</label><br />
                <label>नामः</label><input type="text" class="singleInput" id="RequestMakerName" /><br />
                <label>पद:</label><input type="text" class="singleInput" id="RequestMakerPost" /><br />
                <label>मितिः</label><input id="RequestDate" style="width:200px;"/><br />
                <label>प्रयोजनः</label><input type="text" class="singleInput" id="reqPurpose" /><br />
            </div>
            <div class="col-4">
                <label>सिफारिस गर्ने:</label><br />
                <label>नामः</label><input type="text" class="singleInput" id="RecommenderName"/><br />
                <label>पद:</label><input type="text" class="singleInput" id="RecommenderPost"/><br />
                <label>मितिः</label><input id="RecommendDate" style="width:200px;" />
            </div>
            <div class="col-4">
                <label>स्टोरकिपरले भर्ने:</label><br />
                <label>क) बजारबाट खरिद गर्नुपर्ने</label><input type="radio" name="skRadio" value="false"/><br />
                <label>ख) मौज्दातमा रहेको</label><input type="radio" name="skRadio" value="true"/><br />
                <label>स्टोरकिपरको दस्तखत:</label><br />
                <label>नामः</label><input type="text" class="singleInput" id="StorekeeperName" /><br />
            </div>
        </div>
        <br />
        <div class="container row">
            <div class="col-4">
                <label>मालसामान बुझिलिने:</label><br />
                <label>नामः</label><input type="text" class="singleInput" id="ReceiverName" /><br />
                <label>पद:</label><input type="text" class="singleInput" id="ReceiverPost" /><br />
                <label>मितिः</label><input id="ReceiveDate" style="width:200px;" />
            </div>
            <div class="col-4">
                <label>खर्च निकासा खातामा चढाउने:</label><br />
                <label>नामः</label><input type="text" class="singleInput" id="ExpName" /><br />
                <label>पद:</label><input type="text" class="singleInput" id="ExpPost" /><br />
                <label>मितिः</label><input id="ExpRecordDate" style="width:200px;" />
            </div>
            <div class="col-4">
                <label>स्वीकृत गर्ने:</label><br />
                <label>नामः</label><input type="text" class="singleInput" id="AcceptName" /><br />
                <label>पद:</label><input type="text" class="singleInput" id="AcceptPost" /><br />
                <label>मितिः</label><input id="AcceptedDate" style="width:200px;" />
            </div>
        </div>
        <button type="submit" class="k-btn k-button-solid-success" id="submit">Submit</button>
    </form>
    <br />
    <div class="container pt-3" id="formEnding">
        <h4>उद्देश्य</h4>
        <p>कार्यालयमा अधिकार प्राप्त अधिकारीले आदेश दिए बमोजिम स्टोरमा सम्पत्ति तथा जिन्सी मालसामानको माग र जारी गर्ने पहिचान गर्ने, 
            सोसम्बन्धी नियन्त्रण र वैधानिकता सुनिश्चित गर्ने, मौज्दात नभएको जिन्सी तथा सम्पत्ति खरिद गर्ने । 				
        </p>
        <h5>फाराम भर्ने तरिका:</h5>
        <div class="container">
            <table>
                <tbody>
                    <tr>
                        <td></td>
                        <td>कार्यालय सञ्चालन गर्न आवश्यक पर्ने सम्पत्ति तथा जिन्सी मालसामान (मौज्दात भएमा निकासाको लागि र मौज्दात नभएमा बजारबाट खरिदको लागि) माग गर्न यो फाराम भर्नुपर्दछ ।</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>
    

    <script>
        $(document).ready(function() {
            
            

            
                

            $("#FormDate").kendoDatePicker({
                dateInput: true,
            });
            $("#RequestDate").kendoDatePicker({
                dateInput: true,
            });
            $("#RecommendDate").kendoDatePicker({
                dateInput: true,
            });
        
            $("#ReceiveDate").kendoDatePicker({
                dateInput: true,
            });
            $("#ExpRecordDate").kendoDatePicker({
                dateInput: true,
            });
            $("#AcceptedDate").kendoDatePicker({
                dateInput: true,
            });
            $("#FiscalYear").kendoNumericTextBox({
                size: "small"
            });
            
            $("#requestedQuantities").kendoNumericTextBox({
                size: "small"
            });
            
            $("#requestedUnits").kendoNumericTextBox({
                size: "small"
            });
            $("#FormId").kendoTextBox();

            $("#itemName").kendoTextBox();

            $("#specification").kendoTextBox();

            $("#remarks").kendoTextArea({
                rows: 2,
                maxLength: 50
            });



            function submitForm(event) {
                event.preventDefault();
                var grid = $('#ItemsGrid').data("kendoGrid");
                var gridItems = grid.dataSource.data();
                var Items = gridItems.map(function (item) {
                    return {
                        Name : item.Name,
                        Specification: item.Specification,
                        RequestedQuantities:{
                            Unit : item.Unit,
                            Quantity: item.Quantity
                        },
                        
                        Remarks: item.Remarks
                    };
                });
                console.log(Items);


                var requestForm = 
                    {
                        MLPFormNo: $('#MLPNo').text(),
                        FormName:$('#FormName').text(),
                        OfficeName : $('#OfficeName').val(),
                        OfficeId : $('#OfficeId').val(),
                        FiscalYear : $('#FiscalYear').val(),
                        FormId : $('#FormId').val(),
                        FormDate : $('#FormDate').val(),
                        RequestedBy:{
                            Name: $('#RequestMakerName').val(),
                            Post: $('#RequestMakerPost').val()
                        },
                        RequestDate: $('#RequestDate').val(),
                        RequestPurpose: $('#reqPurpose').val(),
                        RecommendedBy:{
                            Name:$('#RecommenderName').val(),
                            Post:$('#RecommenderPost').val(),
                        },
                        RecommendDate:$('#RecommendDate').val(),
                        Storekeeper:{
                            Name:$('#StorekeeperName').val()
                        },
                        ReceivedBy:{
                            Name:$('#ReceiverName').val(),
                            Post:$('#ReceiverPost').val()
                        },
                        ReceiveDate : $('#ReceiveDate').val(),
                        WasInStock : $("input[name='skRadio']:checked").val(),
                        ExpenseRecordedBy:{
                            Name:$('#ExpName').val(),
                            Post:$('#ExpPost').val()
                        },
                        ExpenseRecordDate: $('#ExpRecordDate').val(),
                        AcceptedBy:{
                            Name: $('#AcceptName').val(),
                            Post:$('#AcceptPost').val()
                        },
                        AcceptedDate:$('#AcceptedDate').val(),
                        Items: Items

                        
                }

           
                $.ajax({
                    type: "POST",
                    url: "/Report401/RequestForm",
                    data: requestForm,
                    success: console.log(requestForm),
                    dataType: "JSON"
                });
            }
                var form = document.getElementById('requestForm');
                form.addEventListener("submit", submitForm);



            //Grid
            var dataSource = new kendo.data.DataSource({
                pageSize: 20,
                data: [],
                schema: {
                    
                    model: {
                        fields: {
                            Name: { type: "string", editable: true, validation: { required: true } },
                            Specification: {type: "string", editable:true, validation: { required: true } },
                            Unit: { type: "number", editable: true, validation: {required:true}},
                            Quantity: { type: "number", editable: true, validation: {required:true}},
                            Remarks:{type: "string", editable:true, validation: { required: true } }
                        }
                    }
                }
            });
            $("#ItemsGrid").kendoGrid({
                autoBind : false,
                dataSource: dataSource,
                pageable: true,
                height: 550,
                toolbar: ["create"],
                
                columns: [
                    { field: "Name", title: "Name" },
                    { field: "Specification", title: "Specification"},
                    {field:"Unit", title:"Unit"},
                    {field:"Quantity", title:"Quantity"},
                    {field:"Remarks", title:"Remarks"},
                    { command: "edit", title: "Edit", width: "100px"},
                    { command: "destroy", title: "Delete", width: "100px" }
                ],
                editable: "inline"
            });
        });

    </script>



