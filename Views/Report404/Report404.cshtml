
@{
    Layout = "_Layout";
}

@model Report404ViewModel
<h1>Expenditure Release Form </h1>

<form>
    <div class="headers ">
        @* //HEADER SECTION OF THE FORM *@
        <div class="k-d-flex k-justify-content-center" style="padding-top: 54px;">
            <div class="container ">
                <div class="row">
                    <div class="k-w-300">
                        <br>
                        <label for="OfficeName"> Ministry / Department / Office:</label>
                        <input id="OfficeName" name="OfficeName" />
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="k-w-300">
                    <br>

                    <label for="OfficeCodeNo"> Office Code No:</label>
                    <input id="OfficeCodeNo" name="OfficeCodeNo" />
                </div>
            </div>
        </div>
        @* Second Line of Input *@

        <div class="Container  mt-5">
            <div class="row">
                <div class="col-sm">
                    <div>
                        <label>Fiscal Year :</label>
                        <input id="FiscalYear" name="FiscalYear" />
                    </div>
                </div>

                <div class="col-sm">
                    <div>
                        <label>Expenditure Claim Form No:</label>
                        <input id="ExpenditureClaimFormNo" name="ExpenditureClaimFormNo" />

                        @* <form id="exampleform"></form> *@

                    </div>
                </div>
                <div class="col-sm">
                    <div>
                        <label>Date</label>
                        <input id="Date" />
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br>

    <div class="modules mt-5">
        <div id="sub_main_info">
            @* SUB INFORMATIONS *@
            <div class="container" id="jincy_information">
                <div class="">
                    <hr>
                    <div class="row">
                        <div class="col-2">
                            @*Name.*@
                            <label for="name">Name:</label>
                            <input name="name[]" class="FormName">
                        </div>
                        <div class="col-2">
                            @*Symbol No.*@
                            <label for="symbol_no">Synbol No:</label>
                            <input name="symbol_no[]" class="symbol_no">
                        </div>
                        <div class="col-2">
                            @*Specification No.*@
                            <label for="specification_no">Specification No:</label>
                            <input name="specification_no[]" class="specification_no">
                        </div>
                        <div class="col-2">
                            @*Akain No.*@
                            <label for="akin_no">Akain No:</label>
                            <input name="akin_no[]" class="aking_no">
                        </div>
                        <div class="col-2">
                            @*Quantity*@
                            <label for="quantity">Quantity:</label>
                            <input name="quantity[]" class="quantity">
                        </div>
                        <div class="col-2">
                            @*Rate*@
                            <label for="rate">Rate:</label>
                            <input name="rate[]" class="rate">
                        </div>
                        <div class="col-3">
                            @*Remarks*@
                            <label for="remarks">Remarks:</label>
                            <textarea name="remarks[]" class="remarks"></textarea>
                        </div>
                    </div>
                    <button class="btn btn-info" id="remove_jincy">Remove</button>
                    <hr>
                </div>

            </div>
        </div>
        <button type="button" id="add_jincy" class="btn btn-info mt-4">Add Malsaman</button>
    </div>
    <button type="button" id="submit_button" class="btn btn-info mt-4">submit</button>
</form>
<h1 class="mt-5">The Filed Information</h1>
<hr>
<div id="grid"></div>



<script>

    $(document).ready(function () {
        var total_jincy_added = 1;
        $("#add_jincy").click(function () {
            var clone = $(`<div class="container" id="jincy_information">
            <div class="">
            <hr>
            <div class="row">
                <div class="col-2">
                @*Name.*@
                    <label for="name">Name:</label>
                        <input name="name[]" class="FormName">
                </div>
                <div class="col-2">
                @*Symbol No.*@
                    <label for="symbol_no">Synbol No:</label>
                    <input name="symbol_no[]" class="symbol_no">
                </div>
                <div class="col-2">
                 @*Specification No.*@
                    <label for="specification_no">Specification No:</label>
                    <input name="specification_no[]" class="specification_no">
                </div>
                <div class="col-2">
                 @*Akain No.*@
                    <label for="akin_no">Akain No:</label>
                    <input name="akin_no[]" class="aking_no">
                </div>
                <div class="col-2">
                  @*Quantity*@
                    <label for="quantity">Quantity:</label>
                    <input name="quantity[]" class="quantity">
                </div>
                <div class="col-2">
                   @*Rate*@
                    <label for="rate">Rate:</label>
                    <input name="rate[]" class="rate">
                </div>
                <div class="col-3">
                   @*Remarks*@
                    <label for="remarks">Remarks:</label>
                    <textarea name="remarks[]" class="remarks"></textarea>
                </div>
                </div>
                <button class="btn btn-info" id="remove_jincy">Remove</button>
                <hr>
            </div>
          </div>`);
            clone.appendTo("#sub_main_info");
            clone.find(".FormName").kendoTextBox();
            clone.find(".remarks").kendoTextArea({
                rows: 4,
                maxLength: 200,
                placeholder: "Write Remarks..."
            });
            clone.find(".rate").kendoNumericTextBox();
            clone.find(".quantity").kendoNumericTextBox();
            clone.find(".aking_no").kendoNumericTextBox();
            clone.find(".specification_no").kendoNumericTextBox();
            clone.find(".symbol_no").kendoNumericTextBox(({
                format: "0"
            }));
            total_jincy_added += 1;
        });

        $("#OfficeName").kendoDropDownList({
            dataSource: {
                data: ["Kathmandu", "Lalitpur", "Bhaktapur", "Kavre", "Toursim Board", "Fewa Lake House"]
            }

        });
        $("#OfficeCodeNo").kendoDropDownList({
            dataSource: {
                transport: {
                    read: {
                        dataType: "json",
                        url: "https://localhost:7187/Home/KarlayaCode",
                    }
                }
            }
        });

        $("#FiscalYear").kendoDropDownList({ dataSource: { data: [2024, 2023, 2022, 2021, 2020, 2019, 2018] } });
        $("#ExpenditureClaimFormNo").kendoNumericTextBox();
        $("#Kharcha_form_number").kendoNumericTextBox();
        $("#Date").kendoDatePicker({
            dateInput: true,
            startTime: new Date(2023, 1, 3, 8, 30, 0),
            endTime: new Date(2024, 2, 3, 17,00, 0)
        });

    @*THE SUBFORM SECTION*@
        $(".symbol_no").kendoNumericTextBox({
            format: "0",
            decimals: 1
        });
        $(".specification_no").kendoNumericTextBox();
        $(".aking_no").kendoNumericTextBox();
        $(".quantity").kendoNumericTextBox();
        $(".rate").kendoNumericTextBox();
        $(".FormName").kendoTextBox();
        $(".remarks").kendoTextArea({
            rows: 4,
            maxLength: 200,
            placeholder: "Write Remarks..."
        });

        $("#sub_main_info").on("click", "#remove_jincy", function () {
            $(this).parent().remove();
        });



        $("#submit_button").click(function () {

            console.log("clicked");
                var nameArray = $("input.FormName").map(function () {
                      return $(this).val();
            }).get();
            @* INPUT Symbol_no VALUE *@
                var symbol_noArray = $("input.symbol_no").map(function () 
                {
                    return $(this).val();
                }).get();
            @* INPUT specification_no *@
                var specification_noArray = $("input.specification_no").map(function () 
                {
                    return $(this).val();
                }).get();
            @* INPUT aking_no *@
                var aking_noArray = $("input.aking_no").map(function () 
                {
                    return $(this).val();
                }).get();
            @* INPUT quantity *@
                var quantityArray = $("input.quantity").map(function () 
                {
                    return $(this).val();
                }).get();
            @* INPUT rate *@
                var rateArray = $("input.rate").map(function () 
                {
                    return $(this).val();
                }).get();
            @* INPUT remarksARRAY *@
                var remarksArray = $("textarea.remarks").map(function () 
                {
                    return $(this).val();
                }).get();


                for (var remark of remarksArray) 
                {
                    console.log(remark + "remark");
                }
                for (var nmae of nameArray) 
                {
                    console.log(nmae + "name");
                }

                for (var i = 0; i < symbol_noArray.length; i += 2) 
                {
                    console.log(symbol_noArray[i] + " symbol");
                }
                for (var i = 0; i < specification_noArray.length; i += 2) {
                    console.log(specification_noArray[i] + "spec");
                }
                for (var i = 0; i < aking_noArray.length; i += 2) {
                    console.log(aking_noArray[i] + "akin");
                }
                for (var i = 0; i < quantityArray.length; i += 2) {
                    console.log(quantityArray[i] + "quantity");
                }
                for (var i = 0; i < rateArray.length; i += 2) {
                    console.log(rateArray[i] + "rate");
                }
                debugger;
                var data = [];
                for (var i = 0; i < total_jincy_added; i++) {
                    var obj = {
                        SN: i + 1,
                        FormName: nameArray[i],
                        Symbol_No: symbol_noArray[i],
                        Specificatin_No: specification_noArray[i],
                        Akin_no: aking_noArray[i],
                        Quantity: quantityArray[i],
                        Rate: rateArray[i],
                        Total: quantityArray[i] * rateArray[i],
                        Remark: remarksArray[i]
                }

                data.push(obj);
                var form = document.getElementById("sub_main_info");
            }
                var jsonOBJ = 
                {
                    PrepareredBy: { id: 1, DateOfPreperation: "2020/5/6", name: "king", post: "pm" },
                RecomendedBy: { id: 1, DateOfPreperation: "2020/5/6", name: "king", post: "pm" },
                AcceptedBy: { id: 1, DateOfPreperation: "2020/5/6", name: "king", post: "pm" },
                    OfficeName: $("#OfficeName").val(),
                    OfficeCodeNo: $("#OfficeCodeNo").val(),
                    FiscalYear: $("#FiscalYear").val(),
                    ExpenditureClaimFormNo: $("#ExpenditureClaimFormNo").val(),
                    Date: $("#Date").val(),
                    SubForms: data
            }
                console.log(jsonOBJ, "this one is the thing brother so why sorry when Haideep Dai is here ");
            debugger;
            $.ajax({
                url: '/Report404/Report404',
                type: 'POST',
                data: jsonOBJ,
                success: function (jsonOBJ) {
                    // Handle the response data
                    console.log("post return true");
                    //nsole.log(data);
                },
                error: function (error) {
                    console.log("Error xxx");
                    console.error('Error:', error);
                }
            });

            for (var i = 0; i < data.length; i++) {
                console.log(data[i], "the length of the js objects");
            }
            
        });
            });
</script>
